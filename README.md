
# DeepSeek 增强版提示工程系统使用教程

## 目录

1. [项目简介](#项目简介)
2. [安装与配置](#安装与配置)
3. [快速开始](#快速开始)
4. [核心功能详解](#核心功能详解)
5. [命令参考](#命令参考)
6. [输入模式详解](#输入模式详解)
7. [任务模式详解](#任务模式详解)
8. [配置选项](#配置选项)
9. [最佳实践](#最佳实践)
10. [常见问题](#常见问题)

## 项目简介

DeepSeek 增强版提示工程系统是一个集成了多层次提示工程技术的智能对话系统。它通过组合认知架构、元提示、系统提示和任务提示，提供了一个功能强大且灵活的AI对话体验。

### 主要特性

- **🧠 多层次提示工程**：融合认知架构、元提示、系统提示和任务提示
- **📝 多种输入模式**：支持普通输入、多行输入、粘贴模式和文件输入
- **🎯 任务专精模式**：针对编程、分析、创意写作、学习等场景优化
- **💾 对话管理**：自动保存对话历史，支持Markdown导出
- **🔧 灵活配置**：支持环境变量、配置文件和运行时配置
- **🐛 调试功能**：自动保存长文本输入，便于调试

## 安装与配置

### 1. 环境要求

- Python 3.8+
- 稳定的网络连接（用于访问DeepSeek API）

### 2. 安装步骤

```bash
# 克隆项目（假设已有项目文件）
git clone https://github.com/AHIJLN/opendeekthing.git

# 安装依赖
pip install -r requirements.txt
```

### 3. 配置API密钥

有三种方式配置API密钥：

#### 方式一：环境变量（推荐）

创建 `.env` 文件：

```bash
DEEPSEEK_API_KEY=sk-your-api-key-here
```

#### 方式二：配置文件

创建 `config.json`：

```json
{
    "api_key": "sk-your-api-key-here",
    "model_name": "deepseek-reasoner",
    "temperature": 1.0,
    "max_tokens": 4000
}
```

或创建 `config.yaml`：

```yaml
api_key: sk-your-api-key-here
model_name: deepseek-reasoner
temperature: 1.0
max_tokens: 4000
```

#### 方式三：直接修改代码

编辑 `config.py` 中的默认值（不推荐用于生产环境）。

## 快速开始

### 1. 启动程序

```bash
python main.py
```

### 2. 基本对话

启动后，您会看到欢迎界面。直接输入您的问题即可开始对话：

```
您: 请帮我写一个Python冒泡排序函数

AI: [AI将提供详细的冒泡排序实现和解释]
```

### 3. 使用命令

在输入时，以 `/` 开头的是命令：

```
您: /help
[显示帮助信息]

您: /task
[显示可用任务模式]

您: /save
[保存当前对话]
```

## 核心功能详解

### 1. 提示工程架构

系统采用四层提示架构：

```
┌─────────────────────────────────────┐
│      认知架构 (Cognitive)           │
│  定义AI的基本思维方式和推理框架      │
├─────────────────────────────────────┤
│       元提示 (Meta-Prompt)          │
│  定义处理流程、质量标准和执行策略    │
├─────────────────────────────────────┤
│      系统提示 (System)              │
│  Claude风格的深度思考链机制         │
├─────────────────────────────────────┤
│      任务提示 (Task)                │
│  针对特定任务的优化指令             │
└─────────────────────────────────────┘
```

### 2. 智能输入检测

系统会自动检测输入可能被截断的情况：

- 输入长度接近限制
- 以问号结束的长文本
- 缺少标点符号的长段落

当检测到可能的截断时，系统会自动切换到多行输入模式。

### 3. 对话历史管理

- **自动保存**：每5轮对话自动保存
- **手动保存**：使用 `/save` 命令
- **历史限制**：自动管理历史长度，保持上下文相关性

### 4. 调试功能

超过200字符的输入会自动保存到 `debug_logs/` 目录，方便问题排查。

## 命令参考

| 命令 | 功能 | 使用场景 |
|------|------|----------|
| `/help` | 显示帮助信息 | 需要了解系统功能时 |
| `/task` | 切换任务模式 | 需要专门的对话模式时 |
| `/save` | 保存当前对话 | 想要保存重要对话时 |
| `/clear` | 清空对话历史 | 开始新的对话主题时 |
| `/input` | 选择输入模式 | 需要更改输入方式时 |
| `/file` | 从文件读取输入 | 有长文本或代码文件时 |
| `/paste` | 进入粘贴模式 | 需要粘贴大量文本时 |
| `/debug` | 测试调试功能 | 验证系统功能时 |
| `/exit` | 退出程序 | 结束使用时 |

## 输入模式详解

### 1. 普通模式（默认）

最简单的输入方式，适合短问题：

```
您: 什么是递归？
```

### 2. 多行模式

适合输入较长的文本或代码：

**触发方式：**
- 在行尾加反斜杠 `\`
- 输入超过200字符时自动触发

**结束方式：**
- 输入 `END`（单独一行）
- 连续两次 Enter

```
您: 请帮我分析这段代码：\
def factorial(n):
    if n <= 1:
        return 1
    return n * factorial(n-1)
END
```

### 3. 粘贴模式

适合从其他地方复制的长文本：

```
您: /paste
[粘贴模式已激活]
[请粘贴内容，然后按 Ctrl+D (Mac/Linux) 或 Ctrl+Z (Windows) 结束]
```

### 4. 文件模式

直接读取文件内容：

```
您: /file
请输入文件路径: /path/to/your/file.txt
```

支持拖拽文件路径到终端。

## 任务模式详解

### 1. 代码助手模式 (code)

专注于编程和技术问题：
- 深入分析代码需求
- 考虑边界情况和错误处理
- 遵循最佳实践
- 提供使用示例

```
您: /task
[选择 1 进入代码模式]
您: 如何优化这个算法的时间复杂度？
```

### 2. 分析助手模式 (analysis)

适合深度分析和问题解决：
- 系统化收集数据点
- 应用分析框架
- 提供结构化发现
- 支持结论与证据

```
您: /task
[选择 2 进入分析模式]
您: 分析这个商业模式的可行性
```

### 3. 创意写作模式 (creative)

用于创意内容生成：
- 理解所需的语调和风格
- 平衡原创性与需求
- 基于反馈迭代
- 添加独特视角

```
您: /task
[选择 3 进入创意模式]
您: 写一个关于AI觉醒的短故事
```

### 4. 学习辅导模式 (learning)

优化教育和知识传授：
- 从学习者当前水平开始
- 将复杂概念分解
- 使用类比和示例
- 定期检查理解

```
您: /task
[选择 4 进入学习模式]
您: 教我理解量子计算的基本概念
```

### 5. 通用对话模式 (default)

适合日常对话和通用问答。

## 配置选项

### 1. 模型参数

```python
# config.py 或环境变量
temperature: 1.0          # 创造性（0-2）
max_tokens: 4000         # 最大输出长度
top_p: 0.95             # 核采样
frequency_penalty: 0.0   # 频率惩罚
presence_penalty: 0.0    # 存在惩罚
```

### 2. 提示控制

```python
enable_cognitive: True   # 启用认知架构
enable_meta: True       # 启用元提示
enable_system: True     # 启用系统提示
enable_task: True       # 启用任务提示
```

### 3. 系统配置

```python
max_history_length: 10   # 历史记录长度
auto_save: False        # 自动保存
save_interval: 5        # 保存间隔
output_dir: "output/conversations"  # 输出目录
```

## 最佳实践

### 1. 输入技巧

- **明确具体**：提供清晰的问题描述和上下文
- **分步提问**：复杂问题可以分解为多个步骤
- **使用示例**：提供输入输出示例有助于理解需求

### 2. 选择合适的模式

- **技术问题** → 代码模式
- **决策分析** → 分析模式
- **内容创作** → 创意模式
- **学习新知识** → 学习模式

### 3. 长文本处理

- 使用文件模式处理超长文本
- 粘贴模式适合中等长度的复制内容
- 多行模式适合手动输入的结构化内容

### 4. 对话管理

- 定期保存重要对话
- 切换主题时清空历史
- 利用自动保存功能防止丢失

## 常见问题

### Q1: 输入被截断怎么办？

系统会自动检测并切换到多行模式。您也可以：
- 主动使用 `/paste` 命令
- 将内容保存到文件后使用 `/file` 命令

### Q2: 如何提高响应质量？

1. 选择合适的任务模式
2. 提供清晰的上下文
3. 使用具体的例子
4. 分步骤提问复杂问题

### Q3: API调用失败怎么办？

检查：
1. API密钥是否正确
2. 网络连接是否正常
3. 是否超过API限制

### Q4: 对话历史太长影响性能？

使用 `/clear` 命令清空历史，或调整 `max_history_length` 配置。

### Q5: 如何自定义提示？

编辑 `prompts/` 目录下的相应文件：
- `cognitive.py` - 认知架构
- `meta.py` - 元提示
- `system.py` - 系统提示
- `task.py` - 任务提示

### Q6: 支持哪些文件格式？

文件输入模式支持任何文本文件，包括：
- `.txt`、`.md`、`.py`、`.js` 等源代码文件
- `.json`、`.yaml`、`.xml` 等配置文件
- 其他UTF-8编码的文本文件

## 高级用法

### 1. 批处理模式

创建输入文件 `batch_input.txt`：

```
请解释什么是机器学习？
---
写一个快速排序算法
---
分析Python和JavaScript的区别
```

使用管道处理：

```bash
python main.py < batch_input.txt > output.txt
```

### 2. 自定义配置文件

创建特定场景的配置：

```json
// creative_config.json
{
    "temperature": 1.5,
    "enable_cognitive": true,
    "enable_meta": true,
    "enable_system": false,
    "default_task_type": "creative"
}
```

### 3. 集成到其他项目

```python
from conversation.manager import ConversationManager

# 创建管理器
manager = ConversationManager(task_type="code")
manager.initialize()

# 对话
response = manager.chat("如何实现二叉树？")
print(response)
```

## 结语

DeepSeek 增强版提示工程系统通过多层次的提示工程技术，为用户提供了一个强大而灵活的AI对话工具。无论您是需要编程帮助、深度分析、创意写作还是学习辅导，这个系统都能够提供专业的支持。

记住，获得最佳体验的关键是：
- 选择合适的任务模式
- 提供清晰的输入
- 善用各种输入方式
- 定期保存重要对话

祝您使用愉快！如有任何问题，请随时使用 `/help` 命令获取帮助。
